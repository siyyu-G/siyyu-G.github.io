import{d as T,K,c as V,r as R,y as G,D as H,e as d,f as N,g as e,h as o,w as l,F as A,o as y,A as I,B,i as $,k as f,q as Q,v as h,t as w,L as W,z as X,M as Y,J as _,N as Z}from"./index-Drv990fL.js";const ee=["onClick"],ne=T({__name:"index",setup(te){let p=K(),v=V([]),u=V(0),a=R({attrName:"",attrValueList:[],categoryId:"",categoryLevel:3}),k=V([]);G(()=>p.c3Id,()=>{v.value=[],p.c3Id&&b()});const b=async()=>{const{c1Id:r,c2Id:t,c3Id:g}=p;let s=await W(r,t,g);s.code===200&&(v.value=s.data)},S=()=>{u.value=1,Object.assign(a,{attrName:"",attrValueList:[],categoryId:"",categoryLevel:3}),a.categoryId=p.c3Id},D=r=>{u.value=1,Object.assign(a,JSON.parse(JSON.stringify(r)))},x=()=>{u.value=0},O=()=>{a.attrValueList.push({valueName:"",flag:!0}),X(()=>{k.value[a.attrValueList.length-1].focus()})},U=async()=>{(await Y(a)).code===200?(u.value=0,_({type:"success",message:a.id?"修改成功":"添加成功"}),b()):_({type:"error",message:a.id?"修改失败":"添加失败"})},q=(r,t)=>{if(r.valueName.trim()===""){a.attrValueList.splice(t,1),_({type:"error",message:"属性值不能为空"});return}if(a.attrValueList.find(s=>{if(s!=r)return s.valueName===r.valueName})){a.attrValueList.splice(t,1),_({type:"error",message:"属性值不能重复"});return}r.flag=!1},z=r=>{r.flag=!0},E=async r=>{(await Z(r)).code===200?(_({type:"success",message:"删除成功"}),b()):_({type:"error",message:"删除失败"})};return H(()=>{p.$reset()}),(r,t)=>{const g=d("Category"),s=d("el-button"),c=d("el-table-column"),J=d("el-tag"),P=d("el-popconfirm"),C=d("el-table"),L=d("el-input"),j=d("el-form-item"),F=d("el-form"),M=d("el-card");return y(),N(A,null,[e(g,{scene:o(u)},null,8,["scene"]),e(M,{class:"card2"},{default:l(()=>[I($("div",null,[e(s,{type:"primary",icon:"Plus",disabled:!o(p).c3Id,onClick:S},{default:l(()=>t[1]||(t[1]=[f("添加属性")])),_:1},8,["disabled"]),e(C,{border:"",style:{width:"100%",margin:"10px 0px"},data:o(v)},{default:l(()=>[e(c,{label:"序号",type:"index",align:"center",width:"80px"}),e(c,{label:"属性名称",width:"120px",prop:"attrName"}),e(c,{label:"属性值名称"},{default:l(({row:n,$index:m})=>[(y(!0),N(A,null,Q(n.attrValueList,(i,ae)=>(y(),h(J,{type:"success",style:{margin:"5px"},key:i.id},{default:l(()=>[f(w(i.valueName),1)]),_:2},1024))),128))]),_:1}),e(c,{label:"操作",width:"150px"},{default:l(({row:n,$index:m})=>[e(s,{type:"warning",size:"samll",icon:"Edit",onClick:i=>D(n)},null,8,["onClick"]),e(P,{title:`你确定要删除${n.attrName}吗？`,width:"200px",onConfirm:i=>E(n.id)},{reference:l(()=>[e(s,{type:"danger",size:"samll",icon:"Delete"})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"])],512),[[B,o(u)===0]]),I($("div",null,[e(F,{inline:!0},{default:l(()=>[e(j,{label:"属性名称"},{default:l(()=>[e(L,{placeholder:"请你输入属性名称",modelValue:o(a).attrName,"onUpdate:modelValue":t[0]||(t[0]=n=>o(a).attrName=n)},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{onClick:O,disabled:!o(a).attrName,type:"primary",icon:"Plus"},{default:l(()=>t[2]||(t[2]=[f("添加属性值")])),_:1},8,["disabled"]),e(s,{type:"primary",onClick:x},{default:l(()=>t[3]||(t[3]=[f("取消")])),_:1}),e(C,{border:"",style:{margin:"10px 0px"},data:o(a).attrValueList},{default:l(()=>[e(c,{width:"80px",type:"index",label:"序号",align:"center"}),e(c,{label:"属性值名称"},{default:l(({row:n,$index:m})=>[n.flag?(y(),h(L,{key:0,ref:i=>o(k)[m]=i,onBlur:i=>q(n,m),modelValue:n.valueName,"onUpdate:modelValue":i=>n.valueName=i,placeholder:"请你输入属性值名称"},null,8,["onBlur","modelValue","onUpdate:modelValue"])):(y(),N("div",{key:1,onClick:i=>z(n)},w(n.valueName),9,ee))]),_:1}),e(c,{label:"操作"},{default:l(({row:n,$index:m})=>[e(s,{type:"danger",size:"small",icon:"Delete",onClick:i=>o(a).attrValueList.splice(m,1)},null,8,["onClick"])]),_:1})]),_:1},8,["data"]),e(s,{type:"primary",onClick:U,disabled:!(o(a).attrValueList.length>0)},{default:l(()=>t[4]||(t[4]=[f("保存")])),_:1},8,["disabled"]),e(s,{type:"primary",onClick:x},{default:l(()=>t[5]||(t[5]=[f("取消")])),_:1})],512),[[B,o(u)===1]])]),_:1})],64)}}});export{ne as default};
