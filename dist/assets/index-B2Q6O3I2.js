import{H as f,d as B,c as v,C as N,e as i,f as O,g as l,w as a,h as r,I as C,F as T,o as j,k as u,i as w,J as c}from"./index-Drv990fL.js";const E=()=>f.get("/admin/acl/permission"),F=d=>d.id?f.put("/admin/acl/permission/update",d):f.post("/admin/acl/permission/save",d),H=d=>f.delete("/admin/acl/permission/remove/"+d),P={class:"dialog-footer"},J=B({__name:"index",setup(d){let b=v([]),o=v(!1),s=v({id:0,code:"",level:0,name:"",pid:0});N(()=>{_()});const _=async()=>{let n=await E();n.code===200&&(b.value=n.data)},k=n=>{Object.assign(s.value,{id:0,code:"",level:0,name:"",pid:0}),o.value=!0,s.value.level=n.level+1,s.value.pid=n.pid},M=n=>{o.value=!0,Object.assign(s.value,n)},x=async()=>{(await F(s.value)).code===200?(c({type:"success",message:"添加成功"}),o.value=!1,_()):c({type:"error",message:"添加失败"})},$=async n=>{(await H(n)).code===200?(c({type:"success",message:"删除成功"}),_()):c({type:"error",message:"删除失败"})};return(n,e)=>{const p=i("el-table-column"),m=i("el-button"),q=i("el-popconfirm"),U=i("el-table"),g=i("el-input"),y=i("el-form-item"),z=i("el-form"),A=i("el-dialog");return j(),O(T,null,[l(U,{data:r(b),style:{width:"100%","margin-bottom":"20px"},"row-key":"id",border:""},{default:a(()=>[l(p,{align:"center",label:"名称",prop:"name"}),l(p,{align:"center",label:"权限值",prop:"code"}),l(p,{align:"center",label:"修改时间",prop:"updataTime"}),l(p,{align:"center",label:"操作"},{default:a(({row:t,$index:R})=>[l(m,{onClick:V=>k(t),type:"primary",size:"small",disabled:t.level===4},{default:a(()=>e[4]||(e[4]=[u("添加")])),_:2},1032,["onClick","disabled"]),l(m,{onClick:V=>M(t),type:"primary",size:"small",disabled:t.level===1},{default:a(()=>e[5]||(e[5]=[u("编辑")])),_:2},1032,["onClick","disabled"]),l(q,{title:`你确定要删除${t.name}吗？`,onConfirm:V=>$(t.id)},{reference:a(()=>[l(m,{type:"danger",size:"small",disabled:t.level===1},{default:a(()=>e[6]||(e[6]=[u("删除")])),_:2},1032,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),l(A,{modelValue:r(o),"onUpdate:modelValue":e[3]||(e[3]=t=>C(o)?o.value=t:o=t),title:"Tips",width:"500"},{footer:a(()=>[w("div",P,[l(m,{onClick:e[2]||(e[2]=t=>C(o)?o.value=!1:o=!1)},{default:a(()=>e[7]||(e[7]=[u("取消")])),_:1}),l(m,{type:"primary",onClick:x},{default:a(()=>e[8]||(e[8]=[u("确定")])),_:1})])]),default:a(()=>[l(z,{"label-width":"80px"},{default:a(()=>[l(y,{label:"名称"},{default:a(()=>[l(g,{modelValue:r(s).name,"onUpdate:modelValue":e[0]||(e[0]=t=>r(s).name=t),placeholder:"请填写名称"},null,8,["modelValue"])]),_:1}),l(y,{label:"权限值"},{default:a(()=>[l(g,{modelValue:r(s).code,"onUpdate:modelValue":e[1]||(e[1]=t=>r(s).code=t),placeholder:"请填写权限值"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}});export{J as default};
