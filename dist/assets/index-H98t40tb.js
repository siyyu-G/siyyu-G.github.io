import{H as y,d as J,u as K,c as p,r as Q,C as W,e as n,f as C,g as a,w as o,h as i,I as k,F as X,o as U,k as x,i as w,t as Y,v as Z,z as ee,J as c}from"./index-Drv990fL.js";const ae=(m,s)=>y.get(`/admin/product/baseTrademark/${m}/${s}`),le=m=>m.id?y.put("/admin/product/baseTrademark/update",m):y.post("/admin/product/baseTrademark/save",m),te=m=>y.delete("/admin/product/baseTrademark/remove/"+m),oe=["src"],re=["src"],ie=J({__name:"index",setup(m){K();let s=p(1),f=p(3),N=p(0),b=p([]),u=p(!1),r=Q({tmName:"",logoUrl:""}),g=p();const _=async(t=1)=>{s.value=t;let e=await ae(s.value,f.value);e.code===200&&(N.value=e.data.total,b.value=e.data.records)};W(()=>{_()});const O=()=>{u.value=!0,r.id=0,r.tmName="",r.logoUrl="",ee(()=>{g.value.clearValidate("tmName"),g.value.clearValidate("logoUrl")})},z=t=>{u.value=!0,Object.assign(r,t)},q=()=>{u.value=!1},E=async()=>{await g.value.validate(),(await le(r)).code===200?(u.value=!1,c({type:"success",message:r.id?"修改品牌成功":"添加品牌成功"}),_(r.id?s.value:1)):(u.value=!1,c({type:"error",message:r.id?"修改品牌失败":"添加品牌失败"}))},L=t=>{if(t.type==="image/png"||t.type==="image/jpeg"||t.type==="image/gif")return t.size/1024/1024<4?!0:(c({type:"error",message:"上传文件大小小于4M"}),!1);c({type:"error",message:"上传文件格式务必为png、jpg或者gif"})},P=(t,e)=>{r.logoUrl=t.data,g.value.clearValidate("logoUrl")},$={tmName:[{required:!0,trigger:"blur",validator:(t,e,d)=>{e.trim().length>=2?d():d(new Error("品牌名称位数要大于等于两位"))}}],logoUrl:[{required:!0,validator:(t,e,d)=>{e?d():d(new Error("务必上传LOGO图片"))}}]},j=async t=>{(await te(t)).code===200?(c({type:"success",message:"删除成功"}),_(b.value.length>1?s.value:s.value-1)):c({type:"error",message:"删除失败"})};return(t,e)=>{const d=n("el-button"),v=n("el-table-column"),A=n("el-popconfirm"),D=n("el-table"),S=n("el-pagination"),G=n("el-card"),H=n("el-input"),T=n("el-form-item"),M=n("Plus"),R=n("el-icon"),h=n("el-upload"),B=n("el-form"),F=n("el-dialog");return U(),C(X,null,[a(G,{style:{}},{default:o(()=>[a(d,{type:"primary",icon:"Plus",onClick:O},{default:o(()=>e[4]||(e[4]=[x("添加品牌")])),_:1}),a(D,{class:"table",border:"",data:i(b)},{default:o(()=>[a(v,{label:"序号",width:"80px",align:"center",type:"index"}),a(v,{label:"品牌名称"},{default:o(({row:l,$index:V})=>[w("pre",null,Y(l.tmName),1)]),_:1}),a(v,{label:"品牌LOGO"},{default:o(({row:l,$index:V})=>[w("img",{src:l.logoUrl,alt:""},null,8,oe)]),_:1}),a(v,{label:"品牌操作"},{default:o(({row:l,$index:V})=>[a(d,{type:"warning",small:"",icon:"Edit",onClick:I=>z(l)},null,8,["onClick"]),a(A,{title:`您确定要删除${l.tmName}?`,width:"250px",icon:"Delete",onConfirm:I=>j(l.id)},{reference:o(()=>[a(d,{type:"danger",small:"",icon:"Delete"})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),a(S,{onChange:_,"current-page":i(s),"onUpdate:currentPage":e[0]||(e[0]=l=>k(s)?s.value=l:s=l),"page-size":i(f),"onUpdate:pageSize":e[1]||(e[1]=l=>k(f)?f.value=l:f=l),"page-sizes":[1,3,5,7,9],background:"true",layout:"prev, pager, next, jumper,-> ,sizes, total",total:i(N)},null,8,["current-page","page-size","total"])]),_:1}),a(F,{modelValue:i(u),"onUpdate:modelValue":e[3]||(e[3]=l=>k(u)?u.value=l:u=l),title:i(r).id?"修改品牌":"添加品牌",width:"500"},{footer:o(()=>[a(d,{type:"primary",onClick:q},{default:o(()=>e[5]||(e[5]=[x("取消")])),_:1}),a(d,{type:"primary",onClick:E},{default:o(()=>e[6]||(e[6]=[x("确定")])),_:1})]),default:o(()=>[a(B,{model:i(r),rules:$,ref_key:"formRef",ref:g},{default:o(()=>[a(T,{label:"品牌名称","label-width":"100px",prop:"tmName"},{default:o(()=>[a(H,{placeholder:"请您输入品牌名称",modelValue:i(r).tmName,"onUpdate:modelValue":e[2]||(e[2]=l=>i(r).tmName=l)},null,8,["modelValue"])]),_:1}),a(T,{label:"品牌LOGO","label-width":"100px",prop:"logoUrl"},{default:o(()=>[a(h,{class:"avatar-uploader",action:"/api/admin/product/fileUpload","show-file-list":!1,"on-success":P,"before-upload":L},{default:o(()=>[i(r).logoUrl?(U(),C("img",{key:0,src:i(r).logoUrl,class:"avatar"},null,8,re)):(U(),Z(R,{key:1,class:"avatar-uploader-icon"},{default:o(()=>[a(M)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])],64)}}});export{ie as default};
